Unpacker ExeCryptor 2.x.x v1.0 RC2, by RSI [tPORt]


Опции:

Clear pointer GetModuleHandleA
------------------------------
Ищет в распакованном файле указатель на дворд, который хранит адрес функции
GetModuleHandleA во внутреннем импорте криптора и:

1. Отображает "Type1" для файлов защищенных EC 2.2.5 или ниже.
   В этом случае надо вручную изменить адрес указателя, чтобы он указывал
   на GetModuleHandle в восстановленном импорте.

2. Отображает "Type2" и очищает указатель для файлов, защищенных EC 2.2.6-2.3.9.

3. Отображает "Not Found pointers" для файлов защищенных EC 2.4.x, где баг
   с GetModuleHandle был исправлен.

[!] Если файл защищен EC 2.3.9 или ниже, то указатель надо обязательно
    обнулить/исправить иначе распакованный файл не будет запускаться
    на других ОС, где адрес функции GetModuleHandle отличается.

Patch message "Debugger Detected
--------------------------------
Ищет начало крипторовской процедуры, которая отображает ошибку "[305] 
Debugger Detected" и закрывает программу при запуске, и отключает ее.
 
1. Method 1 – используется динамический поиск
2. Method 2 – используется статический поиск

[*] Если в логе отображается "Method 3", значит процедура также была
    успешно найдена и отключена.

Patch File CRC Check
--------------------
Ищет и отключает крипторовскую проверку CRC файла. Если же при запуске 
распакованного файла все равно отображается ошибка "File Corrupted!", 
значит помимо проверки CRC файла еще используется проверка CRC памяти.

Patch Memory CRC Check
----------------------
Ищет и отключает крипторовскую проверку CRC памяти.

[!] Используйте на свой страх и риск, т.к. анпакер вставляет бесконечный
    цикл в процедуру, проверяющую CRC памяти, и из-за этого распакованный
    файл может создавать высокую загрузку процессора.
 
Remove trash
------------
Очищает в распакованном файле участок между PE заголовком и первой секцией,
в котором раньше хранились запакованные данные.

Fix Relocs
----------
Восстанавливает у длл релоки, вырезанные криптором:

1. Если опция отмечена, то анпакер сам восстановит релоки, добавит новую
   секцию к распакованному файлу, вставит туда релоки и подправит PE заголовок.

2. Если не отмечена, то анпакер создаст 2 файла ("_reloc1.dll" и "_reloc2.dll")
   и отобразит базу второго файла для восстановления релоков вручную с помощью
   ReloX.

[*] Если в файле много релоков, то работа может занять продолжительное время.

Cut last sections
-----------------
Отрезает секции криптора с упакованными данными (обычно последние две),
которые больше не нужны.

[*] Опция отключена для длл, т.к. из-за нее было много багов. ;-)

Reconstruct Dynamic Import
--------------------------
Автоматически определяет начало/конец IAT и восстанавливает
защищенный криптором импорт. Если анпакер не находит защищенный
импорт, то он отключит эту опцию и начнет распаковку заново.

Fix IAT in dump
---------------
Определяет как импорт прикручивается к распакованному файлу:

1. Если опция отмечена, то анпакер сам добавит к распакованному файлу
   новую секцию, вставит туда восстановленный импорт и подправит PE заголовок.

2. Если не отмечена, то анпакер отобразит окно с данными о начале/размере IAT
   для ручного прикручивания импорта к распакованному файлу с помощью ImpRec.

[*] Не закрывайте окно, пока не прикрутите импорт с помощью ImpRec’а).
 
Copy/Paste original IAT in dump
-------------------------------
Копирует импорт из файла и вставляет его в распакованный. Используйте 
эту опцию когда у файл не защищен импорт.

Save log
--------
Сохраняет лог в файл с именем "_u.log".

Find OEP
--------
Ищет OEP динамическим и статическим методом (трейс и сигнатуры) и если находит,
то прописывает его в PE заголовке.

Для exe файлов сначала применяется динамический поиск OEP, а потом статический.
А для dll наоборот – статический, а потом динамический.

[*] Если анпакер не найдет OEP, то предложит ввести его вручную.


Что нового:

v1.0 release candidate 2
------------------------
* Дофиксены мелкие баги + баги с фиксом импорта
* Добавлен динамический поиск OEP (правда работает в 70% случаев, 
  поэтому оставил еще и статический поиск)
* Добавлен манифест и информация о файле
* Добавлена распаковка длл (восстановление с защищенными релоками

v1.0 release candidate 1
------------------------
* Добавлен собственный алгоритм прикручивания импорта к дампу (без
  сторонних длл)
* Пофиксен баг в восстановлении импорта, для Win XP SP0/SP1
* Пофиксены некоторые мелочи, по определению компиляторов и нахождению OEP

v1.0 beta 4
-----------
* Пофиксены баги в поиске OEP на VC++, Delphi
* Добавлены сигнатуры OEP для VB, MASM и TASM
* Добавлены 2 метода удаления "[305]"

v1.0 beta 3
-----------
* Пофиксены баги с распаковкой EC 2.4.1
* Добавлена опция "Patch Memory CRC Check", для удаления проверки CRC
  памяти в потоках
* Добавлена опция "Remove Sign Detected by Kaspersky, для удаления 
  сигнатуры скарденного криптора, которого палит антивирус Касперского
* Добавлены основные сигнатуры для поиска OEP на С++
* Добавлена опция отображения окна поверх остальных

v1.0 beta 2
-----------
* Исправлены небольшие баги с поиском и восстановлением защищенного импорта
* Немного изменены названия опций, чтобы не так путались
* Прикрутил ap0x unpack engine для прикручивания импорта к дампу
* Добавлена проверка защищен импорт или нет
* Исправлен поиск OEP в Delphi, т.к. на некоторых консольных версиях
  криптора не работал
* Добавлена возможность ввода ОEP вручную, когда анпакер не находит его
* Добавлено отображение включенных опций в лог
* Добавлена поддержку drag'n'drop